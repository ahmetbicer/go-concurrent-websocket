<!DOCTYPE html>
<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/addons/p5.dom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/addons/p5.sound.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <script>
           var x, y, z;
            var xpos, ypos;
            var conn;

            function setup() {
                createCanvas(400, 400);

                conn = new WebSocket("ws://" + document.location.host + "/ws");

                conn.onopen = function () {
                    console.log("socket başladı");
                }

                conn.onmessage = function (evt) {
                    try {
                        let j = JSON.parse(evt.data);
                        x = j.x;
                        y = j.y;
                        z = j.z;
                    } catch (error) {
                        console.log(error, evt);
                    }
                }

                xpos = 200;
                ypos = 200;
                x = 0;
                y = 0;
            }

            function draw() {
                background(255);

                xpos = xpos - x * 2;
                ypos = ypos + y * 2;

                if (xpos > 400) { xpos = 0; }
                if (xpos < 0) { xpos = 400; }
                if (ypos > 400) { ypos = 0; }
                if (ypos < 0) { ypos = 400; }

                fill(255, 0, 0);
                ellipse(xpos, ypos, 25, 25);

                fill(0);
                noStroke();
                text("x: " + x, 25, 25);
                text("y: " + y, 25, 50);
                text("z: " + z, 25, 75);
            }
    </script>
</body>

</html>